<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <div id="imageContainer">
      <img id="deck" src="images/back.png" class="game-cards">
      <img id="image2" src="images/back.png" class="side-cards">
      <img id="image3" src="images/back.png" class="side-cards">
      <img id="image4" src="images/back.png" class="side-cards">
      <img id="image5" src="images/back.png" class="side-cards">
      <img id="image6" src="images/back.png" class="side-cards">
      <img id="image7" src="images/back.png" class="side-cards">
    </div>

    <div id="imageContainerHorses">
        <img id="horseClubs" src="images/cards/ACE_of_CLUBS.png" class="horse-cards">
        <img id="horseDiamonds" src="images/cards/ACE_of_DIAMONDS.png" class="horse-cards">
        <img id="horseHearts" src="images/cards/ACE_of_HEARTS.png" class="horse-cards">
        <img id="horseSpades" src="images/cards/ACE_of_SPADES.png" class="horse-cards">
    </div>

    <script>
        const image = document.getElementById("deck");

        const task = (image) => {
            return new Promise((resolve) => {
                image.addEventListener("click", () => {
                    resolve();
                });
            });
        }
        async function getDataFromAPI() {
            try {
                const response = await fetch("/gameInstructions");
                const data = await response.json();
                return data;
            } catch (error) {
                console.error(error);
            }
        }

        async function loop() {
            const data = await getDataFromAPI();
            console.log(typeof data);
            for(let i = 0; i < data.length; i++) {
                let rank = data[i].card.rank;
                let suit = data[i].card.suit;
                console.log(rank, suit)
                await task(image).then(() => onImageClick(rank,suit, image));
            }       
        }

        loop();

        async function onImageClick(rank, suit, image) {
            image.src = `images/cards/${rank}_of_${suit}.png`;
            console.log("Image clicked");  
        } 

        // async function main() {
        //     await waitForClick(image).then(() => onImageClick(rank, suit,image)); 
        //     console.log("Button was clicked");
        // }




    </script>

  </body>
</html>
